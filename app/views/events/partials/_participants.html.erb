<% unless @event.archived %>
<div class="row pt-4">
    <div class="col-8 col-sm-6 col-md-5 col-lg-4 mx-auto">
        <%= button_tag 'Add Participant',
            type: 'button',
            class: 'btn btn-primary btn-lg col-12',
            data: {
                bs_toggle: 'modal',
                bs_target: '#participantModal'
            } %>
    </div>
</div>
<% end %>
<div class="row pt-3">
    <div class="col-12 col-xl-10 mx-auto table-responsive pt-2">
        <table class="table table-striped table-hover data-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Day</th>
                </tr>
            </thead>
            <tbody>
            <% @participants.each do |participant| %>
                <tr class="table-row" data-bs-toggle="modal" data-bs-target="#participantModal" data-participant="<%= participant.id %>" data-name="<%= participant.user.id %>" data-race="<%= participant.event_detail.event_id %>" data-type="<%= participant.event_detail.event_type_id %>" data-day="<%= participant.participation_day %>">
                    <td><%= "#{participant.user.first_name} #{participant.user.last_name}" %></td>
                    <td><%= participant.event_detail.event_type.name %></td>
                    <td><%= participant.participation_day %></td>
                </tr>
            <% end %>
            </tbody>
        </table>
    </div>
</div>

<!-- Participant Modal -->
<div class="modal fade" id="participantModal" tabindex="-1" role="dialog" aria-labelledby="participantModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form id="participantForm" method="POST" action="/admin/events/participants">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add Participant</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row gy-3">
                        <input class="d-none" id="participant" name="participant"/>
                        <input class="d-none" id="eventId" name="event" value="<%= @event.id %>"/>
                        <input class="d-none" id="test" name="test" value="30"/>
                        <div class="col-12">
                            <label class="form-label" for="name">Participant Name</label>
                            <select class="form-select name" id="name" name="name">
                                <option value="">Select...</option>
                                <% User.where(active: true).order(last_name: :asc).each do |person| %>
                                <option value=<%= person.id %>><%= "#{person.first_name} #{person.last_name}" %></option>
                                <% end %>
                            </select>
                        </div>
                        <div class="col-12">
                            <label class="form-label" for="eventType">Event Type</label>
                            <select class="form-select event" id="eventType" name="eventType">
                                <option value="">Select...</option>
                                <%
                                    EventType.where(brand_id: @event.brand_id).order(display_order: :asc).each do |event_type|
                                %>
                                <option value=<%= event_type.id %>><%= event_type.name %></option>
                                <% end %>
                            </select>
                        </div>
                        <div class="col-12">
                            <p>Participation Day</p>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="day" id="participant-saturday" value="Saturday">
                                <label class="form-check-label" for="participant-saturday">Saturday</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="day" id="participant-sunday" value="Sunday">
                                <label class="form-check-label" for="participant-sunday">Sunday</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a id="delete-participant" class="btn btn-danger mr-auto text-white" data-redirect="events/<%= @event.id %>" data-participant="">Delete</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </div>
        </form>
    </div>
</div>
